import{g as e,p as a}from"./http.379cb87b.js";import{d as t,r as l,H as r,v as o,D as n,h as s,o as i,c as d,b as c,C as u,u as m,s as g,e as p,F as y,K as f,q as h,p as b,a as v,x as $}from"./vendor.d4f367cf.js";const I=h();b("data-v-649d0d48");const _={class:"card-row"},k=c("br",null,null,-1),w={class:"button-area"},x=g("返回"),C=g("删除"),U=c("br",null,null,-1);v();var V=t({expose:[],props:["name"],emits:["callback"],setup(t){const{proxy:h}=$();let b=l(!1),v=r([]),V=r({id:"",name:"",url:"",priority:"",creatorId:""}),N=r([]);function j(){for(let e=0;e<v.length;e++)v[e]=!1;b.value=!1,E()}async function q(){let e;if(e="标签"==h.name?{id:V.id,tagName:V.name,tagImgUrl:V.url,priority:V.priority,creatorId:V.creatorId}:{id:V.id,categoryName:V.name,categoryImgUrl:V.url,priority:V.priority,creatorId:V.creatorId},b.value){const t=await a(`/${"分类"==h.name?"category":"tag"}/update`,e);200==t.code?(h.$emit("callback"),F().then(),h.$notify({title:"成功",message:"更新成功!",type:"success"})):h.$notify.error({title:"错误",message:`更新失败！\n${t.msg}`})}else{e.id=null;const t=await a(`/${"分类"==h.name?"category":"tag"}/save?`,e);200==t.code?(h.$emit("callback"),F().then(),E(),h.$notify({title:"成功",message:"保存成功!",type:"success"})):h.$notify.error({title:"错误",message:`保存失败！\n${t.msg}`})}}async function D(){const a=await e(`/${"分类"==h.name?"category":"tag"}/delete?ids=${V.id}`);200==a.code?(F().then(),h.$notify({title:"成功！",message:"删除成功!",type:"success"})):h.$notify.error({title:"删除失败！",message:`${a.msg}`}),E()}function E(){V.id="",V.name="",V.url="",V.priority=""}async function F(){const a=await e(`/${"分类"==h.name?"category":"tag"}/list?page=1&limit=50&sidx=priority&order=asc`);if(200==a.code){N.length=0;let e=a.page.list;e.forEach(((e,a)=>{N.push({id:e.id,name:"分类"==h.name?e.categoryName:e.tagName,url:"分类"==h.name?e.categoryImgUrl:e.tagImgUrl,priority:e.priority,creatorId:e.creatorId})}));for(let a=0;a<e.length;a++)v[a]=!1}else n({showClose:!0,message:`网络异常！\n ${a.msg}`,type:"error"})}return o((()=>{F().then()})),(e,a)=>{const l=s("el-input"),r=s("el-form-item"),o=s("el-option"),n=s("el-select"),h=s("el-form"),$=s("el-button"),E=s("el-card"),F=s("el-check-tag");return i(),d("div",_,[c(E,{class:"box-card form-area"},{default:I((()=>[c("div",null,[c("h1",null,u(t.name),1),k,c(h,{model:m(V)},{default:I((()=>[c(r,{label:"名称"},{default:I((()=>[c(l,{type:"text",modelValue:m(V).name,"onUpdate:modelValue":a[1]||(a[1]=e=>m(V).name=e),placeholder:"请输入标签名称","show-word-limit":""},null,8,["modelValue"])])),_:1}),c(r,{label:"优先级"},{default:I((()=>[c(n,{modelValue:m(V).priority,"onUpdate:modelValue":a[2]||(a[2]=e=>m(V).priority=e),placeholder:"请选择标签优先级"},{default:I((()=>[c(o,{label:"最高",value:1}),c(o,{label:"高",value:2}),c(o,{label:"普通",value:3}),c(o,{label:"低",value:4}),c(o,{label:"最低",value:5})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])]),c("div",w,[c("div",null,[c($,{type:"primary",round:"",onClick:q},{default:I((()=>[g(u(m(b)?"修改":"添加"),1)])),_:1}),m(b)?(i(),d($,{key:0,round:"",onClick:j},{default:I((()=>[x])),_:1})):p("",!0)]),m(b)?(i(),d($,{key:0,type:"danger",round:"",onClick:D},{default:I((()=>[C])),_:1})):p("",!0)])])),_:1}),c(E,{class:"box-card tag-area"},{default:I((()=>[c("h1",null,"所有"+u(t.name),1),U,(i(!0),d(y,null,f(m(N),((e,a)=>(i(),d(F,{key:a,onChange:e=>function(e){for(let a=0;a<v.length;a++)v[a]=!1;v[e]=!0,b.value=!0,V.id=N[e].id,V.name=N[e].name,V.url=N[e].url,V.priority=N[e].priority,V.creatorId=N[e].creatorId}(a),checked:m(v)[a]},{default:I((()=>[g(u(e.name),1)])),_:2},1032,["onChange","checked"])))),128))])),_:1})])}}});V.__scopeId="data-v-649d0d48";export{V as _};
