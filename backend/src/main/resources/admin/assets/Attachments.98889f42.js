import{d as e,o as t,c as s,F as a,K as l,b as o,e as c,p as n,a as i,v as d,G as r,r as u,H as m,h as p,u as f,I as y,i as g,B as h,q as v,s as k,D as b,x}from"./vendor.d4f367cf.js";import{g as C,a as _,p as w}from"./http.5022a457.js";import{_ as I}from"./FullScreen.d7e9a6db.js";import"./index.a9e29f43.js";n("data-v-1095b9fb");const E={class:"container"},S={key:0,class:"loader"},B={key:1,style:{margin:"auto",color:"#909090"}};i();var H=e({expose:[],props:["hasMore"],setup:e=>(n,i)=>(t(),s("div",E,[e.hasMore?(t(),s("div",S,[(t(),s(a,null,l(5,(e=>o("div",{class:"dot",key:e}))),64))])):c("",!0),e.hasMore?c("",!0):(t(),s("div",B,"没有更多了😭😭~~"))]))});H.__scopeId="data-v-1095b9fb";const L=v();n("data-v-671ee35a");const N={class:"root"},V={class:"btn-area"},j={class:"switch-btn"},z={key:0,class:"ops-btn"},M=k("上传"),T=k("删除"),$={class:"img-area"},q={class:"checked"},A=o("i",{class:"el-icon-upload"},null,-1),D=o("div",{class:"el-upload__text"},[k("将文件拖到此处，或"),o("em",null,"点击上传")],-1);i();var F=e({expose:[],setup(n){const{proxy:i}=x();let v;e({LoadMore:H,FullScreen:I});let k=(new Date).getTime();d((()=>{const e=localStorage.getItem("switchValue");e&&(K.value="0"===e),Q().then((()=>{setTimeout((()=>{R();const e=document.querySelector("#content");window.onresize=()=>R(),e.onscroll=e=>{(new Date).getTime()-k>50&&S(e)}}),500),v=setInterval((()=>{R()}),1e3)}))})),r((()=>{clearInterval(v)}));let E=u(!0),S=({srcElement:e})=>{e.scrollTop+e.clientHeight>e.scrollHeight-50&&E.value&&(P++,Q())},B=u(!1),F={Authorization:localStorage.getItem("Authorization")};async function U(e){200!=e.code?b({showClose:!0,message:`上传失败${e.msg}`,type:"error"}):(J.length=0,P=1,Q().then())}let W=[],G=u(!1),K=u(!1);async function O(){let e=[];W.forEach((t=>e.push(J[t])));const t=await w("/file/delPic",e);if(200==t.code){i.$notify({title:"成功！",message:"删除成功"});const e=document.getElementsByClassName("item"),t=document.getElementsByClassName("checked");W.forEach((s=>{e[s].classList.remove("select"),t[s].style.display="none"})),W=[],J.length=0,P=1,Q().then()}else i.$notify.error({title:"出差啦😢！",message:t.msg,duration:5e3})}r((()=>{localStorage.setItem("switchValue",K.value?"0":"1")}));let P=1,J=m([]);async function Q(){const e=await C(`/file/getImages?page=${P}&limit=30&sidx=id&order=desc`);if(200==e.code){const t=e.data.list;0==t.length&&(E.value=!1),t.forEach(((e,t)=>{J.push(e.resourceUrl)}))}}function R(){let e=document.getElementsByClassName("item");if(0===e.length)return;let t=document.querySelector("#content").clientWidth-50,s=e[0].offsetWidth,a=parseInt(String(t/(s+10))),l=[];for(let o=0;o<e.length;o++)if(o<a)e[o].style.top=0,e[o].style.left=(s+10)*o+"px",l.push(e[o].offsetHeight);else{let t=l[0],s=0;for(let e=0;e<l.length;e++)t>l[e]&&(t=l[e],s=e);e[o].style.top=l[s]+10+"px",e[o].style.left=e[s].offsetLeft+"px",l[s]=l[s]+e[o].offsetHeight+10}}return(e,n)=>{const i=p("el-switch"),d=p("el-button"),r=p("el-image"),u=p("el-upload");return t(),s("div",N,[o("div",V,[o("div",j,[o(i,{style:{display:"block"},modelValue:f(K),"onUpdate:modelValue":n[1]||(n[1]=e=>y(K)?K.value=e:K=e),"active-color":"rgb(243 119 119)","inactive-color":"rgb(11 191 226)","active-text":"复制链接","inactive-text":"操作图片"},null,8,["modelValue"])]),o(g,{name:"el-fade-in-linear"},{default:L((()=>[f(K)?c("",!0):(t(),s("div",z,[o(d,{type:"primary",onClick:n[2]||(n[2]=e=>y(B)?B.value=!0:B=!0)},{default:L((()=>[M])),_:1}),o(d,{type:"danger",onClick:O},{default:L((()=>[T])),_:1})]))])),_:1})]),o("div",$,[(t(!0),s(a,null,l(f(J),((e,a)=>(t(),s("div",{class:"item",onClick:e=>function(e,t){if(K.value){let e=document.createElement("input");const s=J[t].split("-",5);e.value=_(s[0]+"-"+s[1]+"-"+s[2]+"-"+s[4]),e.style.opacity="0",e.setAttribute("name","secukey"),document.body.appendChild(e),e.select(),document.execCommand("Copy"),e.id="oInput",e.remove(),b.success({message:"复制成功!",type:"success"})}else{const e=document.getElementsByClassName("item")[t],s=document.getElementsByClassName("checked")[t];let a;-1==(a=W.indexOf(t))?(W.push(t),e.classList.add("select"),s.style.display="block",G.value=!0):(W.splice(a,1),e.classList.remove("select"),s.style.display="none",G.value=W.length>0)}}(0,a),key:e},[o("div",q,[o("img",{src:f("/admin/assets/check.a3d3306e.svg"),alt:""},null,8,["src"])]),o(r,{key:e,src:f(_)(e),lazy:""},null,8,["src"])],8,["onClick"])))),128))]),o(g,{name:"el-fade-in-linear"},{default:L((()=>[f(B)?(t(),s(I,{key:0,opacity:.5,index:3e3,onClick:n[4]||(n[4]=e=>y(B)?B.value=!1:B=!1)},{default:L((()=>[o(u,{onClick:n[3]||(n[3]=h((()=>{}),["stop"])),class:"upload-demo",drag:"",action:f(_)("/backend/file/upload"),"list-type":"picture",headers:f(F),"on-success":U,multiple:""},{default:L((()=>[A,D])),_:1},8,["action","headers"])])),_:1},8,["opacity"])):c("",!0)])),_:1})])}}});F.__scopeId="data-v-671ee35a";export default F;
