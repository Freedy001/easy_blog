import{g as e,p as t}from"./http.706faa12.js";import{d as a,g as l,f as s,H as r,v as o,r as i,h as n,o as u,c as d,b as c,s as p,C as f,F as m,K as g,u as h,q as b,p as w,a as y,x as v}from"./vendor.d4f367cf.js";import{_ as C}from"./ArticleSettingDrawer.6335c3c3.js";import"./index.aaca4a91.js";import"./ImgDrawer.c1a29319.js";import"./Upload.4dbf0c23.js";import"./FullScreen.d7e9a6db.js";import"./CategoryOrTagCard.646d30f3.js";const _=b();w("data-v-14249faa");const k={class:"root"},x={style:{width:"100%",height:"auto","word-break":"break-all",overflow:"hidden"}},T={class:"status"},j={class:"test"},S=p("编辑"),$=p("设置 "),D=p("删除");y();var O=a({expose:[],setup(b){a({ArticleSettingDrawer:C});const{proxy:w}=v(),y=l(),O=s();let I=r([]);o((async()=>{z().then()}));let N=1,q=i(1);async function z(){let t;if(t=await e(`/article/list?page=${N}&limit=16`),200==t.code){I.length=0,q.value=t.data.totalPage;t.data.list.forEach(((e,t)=>{switch(e.articleStatus){case 1:e.dotColor="#fdf000",e.status="未发布";break;case 2:e.dotColor="#f6074e",e.status="回收站";break;case 3:e.dotColor="#52c41a",e.status="已发布";break;case 4:e.dotColor="#10fcf5",e.status="顶置";break;case 5:e.dotColor="#125ee3",e.status="推荐"}I.push(e)}))}else w.$notify.error({title:"出差啦😢！",message:t.msg})}function E(e){N=e,z()}let A=i(),B=i(!1),F=i();async function P(e){let a=[],l=[];e.tagValue.forEach(((e,t)=>{"number"==typeof e?a.push(e):"string"==typeof e&&l.push(e)}));const s=await t("/article/saveOrUpdate",{id:A.value,title:e.title,publishTime:e.publishTime.getTime(),isComment:e.isComment,articleStatus:e.articleStatus,isOverhead:e.isOverhead,authorId:e.authorId,articleCategoryId:e.category,articleDesc:e.desc,articlePoster:e.url,existedTags:a,notExistedTag:l});200==s.code?(w.$notify({title:"成功",message:"保存成功!",type:"success"}),I.length=0,N=1,z().then()):w.$notify.error({title:"出差啦😢！",message:s.msg})}return(t,a)=>{const l=n("el-tag"),s=n("el-form-item"),r=n("el-form"),o=n("el-table-column"),i=n("el-button"),b=n("el-table"),v=n("el-pagination");return u(),d("div",k,[c(b,{class:"article-table",data:h(I),style:{width:"100%"}},{default:_((()=>[c(o,{type:"expand"},{default:_((e=>[c(r,{"label-position":"left",inline:"",class:"demo-table-expand"},{default:_((()=>[c(s,{label:"分类"},{default:_((()=>[c(l,null,{default:_((()=>[p(f(e.row.articleCategory),1)])),_:2},1024)])),_:2},1024),c(s,{label:"标签"},{default:_((()=>[(u(!0),d(m,null,g(e.row.articleTags,(e=>(u(),d(l,{type:"success"},{default:_((()=>[p(f(e),1)])),_:2},1024)))),256))])),_:2},1024),c(s,{label:"作者"},{default:_((()=>[c("span",null,f(e.row.authorName),1)])),_:2},1024),c(s,{label:"发布时间"},{default:_((()=>[c("span",null,f(e.row.publishTime),1)])),_:2},1024),c(s,{label:"访问数"},{default:_((()=>[c("span",null,f(e.row.visitNum),1)])),_:2},1024),c(s,{label:"更新时间"},{default:_((()=>[c("span",null,f(e.row.updateTime),1)])),_:2},1024),c(s,{label:"文章描述"},{default:_((()=>[c("div",x,f(e.row.articleDesc),1)])),_:2},1024)])),_:2},1024)])),_:1}),c(o,{label:"标题","min-width":"200px",prop:"title"}),c(o,{label:"状态"},{default:_((e=>[c("div",T,[c("span",{class:"dot",style:{backgroundColor:e.row.dotColor}},null,4),c("span",j,f(e.row.status),1)])])),_:1}),c(o,{label:"点赞数"},{default:_((e=>[c("span",null,f(e.row.likeNum),1)])),_:1}),c(o,{label:"评论数"},{default:_((e=>[c("span",null,f(e.row.commentNum),1)])),_:1}),c(o,{label:"操作","min-width":"250px"},{default:_((t=>[c(i,{type:"primary",size:"mini",onClick:e=>{return a=t.row.id,void(""!==O.state.articleContent?w.$confirm("你貌似还有文章没保存，直接编辑文章将会覆盖你原来的文章,你确定要继续吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{y.push({path:"/index/article",query:{id:a}})})):y.push({path:"/index/article",query:{id:a}}));var a},round:""},{default:_((()=>[S])),_:2},1032,["onClick"]),c(i,{type:"success",size:"mini",onClick:e=>{return a=t.row.id,l=t.row.articleStatus,F.value=l,A.value=a,void(B.value=!B.value);var a,l},round:""},{default:_((()=>[$])),_:2},1032,["onClick"]),c(i,{type:"danger",size:"mini",onClick:a=>async function(t){const a=await e(`/article/delete?ids=${t}`);200==a.code?(w.$notify({title:"成功",message:"删除成功!",type:"success"}),I.length=0,N=1,z().then()):w.$notify.error({title:"出差啦😢！",message:a.msg})}(t.row.id),round:""},{default:_((()=>[D])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),c(v,{small:"",background:"",layout:"prev, pager, next","page-count":h(q),onCurrentChange:E},null,8,["page-count"]),c(C,{id:h(A),status:h(F),isOpenDrawer:h(B),onSaveCallback:P},null,8,["id","status","isOpenDrawer"])])}}});O.__scopeId="data-v-14249faa";export default O;
