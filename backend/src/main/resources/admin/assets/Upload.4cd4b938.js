import{d as e,f as a,H as s,r as o,h as t,o as c,c as l,b as r,B as i,u as n,q as u,p as d,s as p,a as f,D as m,x as h}from"./vendor.d4f367cf.js";import{a as y,g}from"./http.a8f0cc34.js";import{_}from"./FullScreen.d7e9a6db.js";const v=u();d("data-v-fe48c70e");const x=r("i",{class:"el-icon-upload"},null,-1),b=r("div",{class:"el-upload__text"},[p("将文件拖到此处，或"),r("em",null,"点击上传")],-1);f();var k=e({expose:[],emits:["successCB"],setup(u){e({FullScreen:_});let d={Authorization:localStorage.getItem("Authorization")};const p=a(),{proxy:f}=h(),k=p.state.userInfo.uploadMode;let C=s({}),I=o("/backend/file/upload");async function j(e){if(k)return I.value="/backend/file/upload",!0;{d.Authorization=null;const a=await g(`file/getPolicy?fileName=${e.name}`);if(200==a.code){const e=a.data;return C.policy=e.policy,C.signature=e.signature,C.ossaccessKeyId=e.accessid,C.key=e.fileName,C.dir=e.dir,C.host=e.host,I.value=e.host,!0}return m({showClose:!0,message:`上传失败${a.msg}`,type:"error"}),!1}}function z(){m("上传成功！"),f.$emit("successCB")}function A(){m("上传失败！")}return(e,a)=>{const s=t("el-upload");return c(),l(_,{opacity:.5,index:3e3},{default:v((()=>[r(s,{onClick:a[1]||(a[1]=i((()=>{}),["stop"])),class:"upload-demo",drag:"",data:n(C),"before-upload":j,action:n(y)(n(I)),"list-type":"picture",headers:n(d),"on-success":z,"on-error":A,multiple:""},{default:v((()=>[x,b])),_:1},8,["data","action","headers"])])),_:1},8,["opacity"])}}});k.__scopeId="data-v-fe48c70e";export{k as _};
